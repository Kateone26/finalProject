{% extends 'main.html' %}

{% block title %} <title>Reading CV</title> {% endblock %}

{% block content %}
<div style="display: flex; gap: 20px; align-items: center; padding: 20px; border: 1px solid #ced4da; border-radius: 10px; background-color: #f8f9fa;">
    <img
        style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 2px solid #198754;"
        src="{{ cv_file.image.url }}"
        alt="Talent Image">
    <div>
        <h1 style="font-size: 16px; color: #198754; margin: 0 0 10px 0;"><strong>Talent ID:</strong> {{ cv_file.talentCode }}</h1>
        <h2 style="font-size: 28px; color: #198754; margin: 0 0 10px 0;">
            {% for position in cv_file.positions.all %}
                {{ position.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </h2>
        <p style="font-size: 18px; color: #555; margin: 0 0 10px 0;"><strong>Bio:</strong> {{ cv_file.bio }}</p>
        <p style="font-size: 18px; color: #333; margin: 0;">
            <strong>Skills:</strong>
            {% for skill in cv_file.skills.all %}
                {{ skill.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </p>
    </div>
</div>

<div style="display: flex; gap: 50px; margin: 20px auto; max-width: 1800px; padding: 20px;">
    <!-- PDF Viewer -->

    <div style="flex: 0 0 75%; text-align: center;">
        {% load static %}
        <embed src="{% static cv_file.file.url %}" width="100%" height="1000px" style="border: 1px solid #ced4da;">
    </div>

    <!-- Comments -->
    <div style="flex: 1; max-width: 25%; margin-left: 20px; padding: 10px; border: 1px solid #ced4da; border-radius: 10px; background-color: #f8f9fa;">
        <h4 style="font-size: 22px; color: #198754; margin-bottom: 20px;">Comments</h4>
        {% if request.user.is_authenticated %}
            <form action="" method="POST" style="margin-bottom: 20px;">
                {% csrf_token %}
                <textarea name="body" placeholder="Type your Comment" style="width: 100%; height: 100px; border-radius: 10px; padding: 10px; border: 1px solid #ced4da;"></textarea>
                <button type="submit" class="btn btn-success">Submit Comment</button>
            </form>
        {% endif %}

        {% for comment in cv_comments %}
            <div style="margin-bottom: 20px; padding: 10px; border: 1px solid #ced4da; border-radius: 10px; background-color: #ffffff;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <a href="{% url 'profile' comment.user.id %}" style="display: flex; align-items: center; gap: 10px; text-decoration: none; color: #333;">
                            <img style="width: 35px; height: 35px; border-radius: 50%; object-fit: cover;" class="avatar" src="{{ comment.user.avatar.url }}" alt="Avatar">
                            <p style="margin: 0; font-weight: 700;">@{{ comment.user.username }}</p>
                        </a>
                    </div>
                    <p style="margin: 0; color: #888;">Commented {{ comment.created | timesince }}</p>
                </div>
                <p style="margin: 0; font-size: 18px; color: #333;">{{ comment.body }}</p>
                {% if comment.user == request.user %}
                    <a href="{% url 'delete_comment' comment.id %}" style="color: red; text-decoration: none; margin-top: 10px; display: inline-block;">Delete Comment</a>
                {% endif %}
                <hr style="border-top: 1px solid #ced4da;">
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
